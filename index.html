<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Manajemen Toko - Sistem POS Offline</title>
    <meta name="description" content="Aplikasi manajemen toko offline untuk mengelola stok, penjualan, dan keuangan">
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#10b981">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ida Buah">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Barcode Scanner Library -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <!-- Password Hashing Library -->
    <script src="https://unpkg.com/bcryptjs@2.4.3/dist/bcrypt.min.js"></script>
    <!-- Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Mobile Menu Button -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Toggle Menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="32" height="32" rx="8" fill="#10b981"/>
                    <path d="M16 8L8 14V24H12V18H20V24H24V14L16 8Z" fill="white"/>
                </svg>
                <h1>Ida Groceries</h1>
            </div>
            <div class="user-info" id="user-info">
                <div class="user-avatar">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M10 10C12.2091 10 14 8.20914 14 6C14 3.79086 12.2091 2 10 2C7.79086 2 6 3.79086 6 6C6 8.20914 7.79086 10 10 10Z"
                            fill="currentColor" />
                        <path d="M3 18C3 14.134 6.13401 11 10 11C13.866 11 17 14.134 17 18H3Z" fill="currentColor" />
                    </svg>
                </div>
                <div class="user-details">
                    <p class="user-name" id="user-name">Loading...</p>
                    <p class="user-role" id="user-role">-</p>
                </div>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <a href="#dashboard" class="nav-item active" data-page="dashboard">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 4C3 3.44772 3.44772 3 4 3H7C7.55228 3 8 3.44772 8 4V7C8 7.55228 7.55228 8 7 8H4C3.44772 8 3 7.55228 3 7V4Z" fill="currentColor"/>
                    <path d="M3 13C3 12.4477 3.44772 12 4 12H7C7.55228 12 8 12.4477 8 13V16C8 16.5523 7.55228 17 7 17H4C3.44772 17 3 16.5523 3 16V13Z" fill="currentColor"/>
                    <path d="M13 3C12.4477 3 12 3.44772 12 4V7C12 7.55228 12.4477 8 13 8H16C16.5523 8 17 7.55228 17 7V4C17 3.44772 16.5523 3 16 3H13Z" fill="currentColor"/>
                    <path d="M12 13C12 12.4477 12.4477 12 13 12H16C16.5523 12 17 12.4477 17 13V16C17 16.5523 16.5523 17 16 17H13C12.4477 17 12 16.5523 12 16V13Z" fill="currentColor"/>
                </svg>
                <span>Dashboard</span>
            </a>
            
            <a href="#products" class="nav-item" data-page="products">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 3C3.44772 3 3 3.44772 3 4V6C3 6.55228 3.44772 7 4 7H16C16.5523 7 17 6.55228 17 6V4C17 3.44772 16.5523 3 16 3H4Z" fill="currentColor"/>
                    <path d="M4 9C3.44772 9 3 9.44772 3 10V16C3 16.5523 3.44772 17 4 17H16C16.5523 17 17 16.5523 17 16V10C17 9.44772 16.5523 9 16 9H4Z" fill="currentColor"/>
                </svg>
                <span>Produk</span>
            </a>
            
            <a href="#pos" class="nav-item" data-page="pos">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 3C2.44772 3 2 3.44772 2 4V7C2 7.55228 2.44772 8 3 8H17C17.5523 8 18 7.55228 18 7V4C18 3.44772 17.5523 3 17 3H3Z" fill="currentColor"/>
                    <path d="M4 10C3.44772 10 3 10.4477 3 11V16C3 16.5523 3.44772 17 4 17H7C7.55228 17 8 16.5523 8 16V11C8 10.4477 7.55228 10 7 10H4Z" fill="currentColor"/>
                    <path d="M10 11C10 10.4477 10.4477 10 11 10H16C16.5523 10 17 10.4477 17 11V16C17 16.5523 16.5523 17 16 17H11C10.4477 17 10 16.5523 10 16V11Z" fill="currentColor"/>
                </svg>
                <span>Kasir</span>
            </a>
            
            <a href="#transactions" class="nav-item" data-page="transactions">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 4C3 3.44772 3.44772 3 4 3H16C16.5523 3 17 3.44772 17 4V5C17 5.55228 16.5523 6 16 6H4C3.44772 6 3 5.55228 3 5V4Z" fill="currentColor"/>
                    <path d="M3 8C3 7.44772 3.44772 7 4 7H16C16.5523 7 17 7.44772 17 8V9C17 9.55228 16.5523 10 16 10H4C3.44772 10 3 9.55228 3 9V8Z" fill="currentColor"/>
                    <path d="M4 11C3.44772 11 3 11.4477 3 12V13C3 13.5523 3.44772 14 4 14H16C16.5523 14 17 13.5523 17 13V12C17 11.4477 16.5523 11 16 11H4Z" fill="currentColor"/>
                    <path d="M3 16C3 15.4477 3.44772 15 4 15H10C10.5523 15 11 15.4477 11 16V17C11 17.5523 10.5523 18 10 18H4C3.44772 18 3 17.5523 3 17V16Z" fill="currentColor"/>
                </svg>
                <span>Transaksi</span>
            </a>
            
            <a href="#reports" class="nav-item" data-page="reports">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 11C2 10.4477 2.44772 10 3 10H5C5.55228 10 6 10.4477 6 11V16C6 16.5523 5.55228 17 5 17H3C2.44772 17 2 16.5523 2 16V11Z" fill="currentColor"/>
                    <path d="M8 7C8 6.44772 8.44772 6 9 6H11C11.5523 6 12 6.44772 12 7V16C12 16.5523 11.5523 17 11 17H9C8.44772 17 8 16.5523 8 16V7Z" fill="currentColor"/>
                    <path d="M15 3C14.4477 3 14 3.44772 14 4V16C14 16.5523 14.4477 17 15 17H17C17.5523 17 18 16.5523 18 16V4C18 3.44772 17.5523 3 17 3H15Z" fill="currentColor"/>
                </svg>
                <span>Laporan</span>
            </a>
            <a href="#discounts" class="nav-item" data-page="discounts">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 2L2 7L10 12L18 7L10 2Z" fill="currentColor" />
                    <path d="M2 12L10 17L18 12" stroke="currentColor" stroke-width="2" />
                    <circle cx="10" cy="7" r="2" fill="white" />
                </svg>
                <span>Diskon</span>
            </a>
            <a href="#customers" class="nav-item" data-page="customers">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M10 9C11.6569 9 13 7.65685 13 6C13 4.34315 11.6569 3 10 3C8.34315 3 7 4.34315 7 6C7 7.65685 8.34315 9 10 9Z"
                        fill="currentColor" />
                    <path d="M3 18C3 14.134 6.13401 11 10 11C13.866 11 17 14.134 17 18H3Z" fill="currentColor" />
                </svg>
                <span>Pelanggan</span>
            </a>
            
            <a href="#debts" class="nav-item" data-page="debts">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M4 4C2.89543 4 2 4.89543 2 6V7H18V6C18 4.89543 17.1046 4 16 4H4Z" fill="currentColor" />
                    <path fill-rule="evenodd"
                        d="M18 9H2V14C2 15.1046 2.89543 16 4 16H16C17.1046 16 18 15.1046 18 14V9ZM4 13C4 12.4477 4.44772 12 5 12H6C6.55228 12 7 12.4477 7 13C7 13.5523 6.55228 14 6 14H5C4.44772 14 4 13.5523 4 13ZM9 12C8.44772 12 8 12.4477 8 13C8 13.5523 8.44772 14 9 14H10C10.5523 14 11 13.5523 11 13C11 12.4477 10.5523 12 10 12H9Z"
                        clip-rule="evenodd" fill="currentColor" />
                </svg>
                <span>Hutang</span>
            </a>
            <a href="#users" class="nav-item" data-page="users">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 6C9 7.65685 7.65685 9 6 9C4.34315 9 3 7.65685 3 6C3 4.34315 4.34315 3 6 3C7.65685 3 9 4.34315 9 6Z"
                        fill="currentColor" />
                    <path
                        d="M17 6C17 7.65685 15.6569 9 14 9C12.3431 9 11 7.65685 11 6C11 4.34315 12.3431 3 14 3C15.6569 3 17 4.34315 17 6Z"
                        fill="currentColor" />
                    <path
                        d="M12.9291 10.9286C11.4438 9.97855 9.59924 9.99926 8.13176 10.9821C6.66428 11.965 5.81575 13.7065 6 15.4999H14C14.1843 13.7065 13.3357 11.965 11.8682 10.9821C11.5587 10.7839 11.2415 10.6354 10.9291 10.5357"
                        fill="currentColor" />
                    <path d="M2 16C2 13.7909 3.79086 12 6 12C8.20914 12 10 13.7909 10 16H2Z" fill="currentColor" />
                </svg>
                <span>Pengguna</span>
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <button class="btn-logout" id="logout-btn">
                <svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M3 3C2.44772 3 2 3.44772 2 4V16C2 16.5523 2.44772 17 3 17H10C10.5523 17 11 16.5523 11 16V14H9V15H4V5H9V6H11V4C11 3.44772 10.5523 3 10 3H3Z"
                        fill="currentColor" />
                    <path
                        d="M16.293 10.707L14.586 12.414L15.293 13.121L18.414 10L15.293 6.879L14.586 7.586L16.293 9.293H7V10.707H16.293Z"
                        fill="currentColor" />
                </svg>
                <span>Logout</span>
            </button>
            <div class="offline-indicator">
                <div class="status-dot"></div>
                <span>Mode Offline</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <section id="dashboard-page" class="page active">
            <header class="page-header">
                <h2>Dashboard</h2>
                <p class="page-subtitle">Ringkasan penjualan dan stok toko</p>
            </header>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon green">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Penjualan Hari Ini</p>
                        <h3 class="stat-value" id="today-sales">Rp 0</h3>
                        <p class="stat-change positive" id="sales-change">+0%</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M3 9H21" stroke="currentColor" stroke-width="2"/>
                            <path d="M9 3V21" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Total Produk</p>
                        <h3 class="stat-value" id="total-products">0</h3>
                        <p class="stat-change" id="products-info">Item</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 2L7 7H2L6 10L4 15L9 12L14 15L12 10L16 7H11L9 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Transaksi Hari Ini</p>
                        <h3 class="stat-value" id="today-transactions">0</h3>
                        <p class="stat-change" id="transactions-info">Transaksi</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2V22M17 5H9.5C8.57174 5 7.6815 5.36875 7.02513 6.02513C6.36875 6.6815 6 7.57174 6 8.5C6 9.42826 6.36875 10.3185 7.02513 10.9749C7.6815 11.6313 8.57174 12 9.5 12H14.5C15.4283 12 16.3185 12.3687 16.9749 13.0251C17.6313 13.6815 18 14.5717 18 15.5C18 16.4283 17.6313 17.3185 16.9749 17.9749C16.3185 18.6313 15.4283 19 14.5 19H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Laba Bersih</p>
                        <h3 class="stat-value" id="net-profit">Rp 0</h3>
                        <p class="stat-change positive" id="profit-change">+0%</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon yellow">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 4C2.89543 4 2 4.89543 2 6V7H22V6C22 4.89543 21.1046 4 20 4H4Z" fill="currentColor" />
                            <path fill-rule="evenodd"
                                d="M22 9H2V18C2 19.1046 2.89543 20 4 20H20C21.1046 20 22 19.1046 22 18V9ZM6 15C6 14.4477 6.44772 14 7 14H9C9.55228 14 10 14.4477 10 15C10 15.5523 9.55228 16 9 16H7C6.44772 16 6 15.5523 6 15Z"
                                clip-rule="evenodd" fill="currentColor" />
                        </svg>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Piutang Aktif</p>
                        <h3 class="stat-value" id="total-credit">Rp 0</h3>
                        <p class="stat-change" id="credit-info">0 Pelanggan</p>
                    </div>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>Stok Rendah</h3>
                        <span class="badge badge-warning" id="low-stock-count">0</span>
                    </div>
                    <div class="card-body">
                        <div id="low-stock-list" class="list-container">
                            <div class="empty-state">
                                <p>Semua produk memiliki stok yang cukup</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Pelanggan Berutang</h3>
                        <a href="#debts" class="btn btn-text" onclick="navigateToPage('debts')">Lihat Semua</a>
                    </div>
                    <div class="card-body">
                        <div id="credit-customers-list" class="list-container">
                            <div class="empty-state">
                                <p>Tidak ada piutang aktif</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Transaksi Terbaru</h3>
                    </div>
                    <div class="card-body">
                        <div id="recent-transactions" class="list-container">
                            <div class="empty-state">
                                <p>Belum ada transaksi hari ini</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Products Page -->
        <section id="products-page" class="page">
            <header class="page-header">
                <div>
                    <h2>Manajemen Produk</h2>
                    <p class="page-subtitle">Kelola produk dan stok toko</p>
                </div>
                <button class="btn btn-primary" id="add-product-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Tambah Produk
                </button>
            </header>
            
            <div class="card">
                <div class="card-header products-header">
                    <div class="search-box-enhanced">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <input type="text" id="search-products" placeholder="Cari produk berdasarkan nama...">
                        <button class="clear-search" id="clear-search-btn" style="display: none;">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </button>
                    </div>
                    <div class="filter-group-enhanced">
                        <label for="filter-category">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M2 4H14M4 8H12M6 12H10" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            Kategori
                        </label>
                        <select id="filter-category" class="select-input-enhanced">
                            <option value="">Semua Kategori</option>
                            <option value="makanan">üç± Makanan</option>
                            <option value="minuman">ü•§ Minuman</option>
                            <option value="snack">üçø Snack</option>
                            <option value="lainnya">üì¶ Lainnya</option>
                            </select>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-container">
                        <table id="products-table">
                            <thead>
                                <tr>
                                    <th>Nama Produk</th>
                                    <th>Kategori</th>
                                    <th>Harga</th>
                                    <th>Stok</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="products-tbody">
                                <tr class="empty-row">
                                    <td colspan="5">
                                        <div class="empty-state">
                                            <p>Belum ada produk. Klik "Tambah Produk" untuk memulai.</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- POS Page -->
        <section id="pos-page" class="page">
            <header class="page-header">
                <h2>Kasir (Point of Sale)</h2>
                <p class="page-subtitle">Proses transaksi penjualan</p>
            </header>
            
            <div class="pos-grid">
                <div class="card">
                    <div class="card-header">
                        <h3>Pilih Produk</h3>
                    </div>
                    <div class="card-body">
                        <div class="search-box-enhanced">
                            <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M19 19L14.65 14.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            <input type="text" id="search-pos-products" placeholder="Cari produk untuk ditambahkan...">
                            <button class="clear-search" id="clear-pos-search-btn" style="display: none;">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                </svg>
                            </button>
                            <button class="btn btn-icon" id="scan-barcode-pos-btn" title="Scan Barcode">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
                                    <path d="M7 7V17M10 7V17M13 7V17M16 7V17" stroke="currentColor" stroke-width="2" />
                                </svg>
                            </button>
                        </div>
                        <div id="pos-products-list" class="products-grid">
                            <!-- Products will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <div class="card pos-cart">
                    <div class="card-header">
                        <h3>Keranjang</h3>
                        <button class="btn btn-text" id="clear-cart-btn">Kosongkan</button>
                    </div>
                    <div class="card-body">
                        <div id="cart-items" class="cart-items-list">
                            <div class="empty-state">
                                <p>Keranjang kosong</p>
                            </div>
                        </div>
                    </div>
                    <div class="cart-footer">
                        <div class="cart-totals">
                            <div class="cart-total-row">
                                <span>Subtotal:</span>
                                <span id="cart-subtotal">Rp 0</span>
                            </div>
                            <div class="cart-total-row" style="color: var(--color-success);">
                                <span>Diskon:</span>
                                <span id="cart-discount">Rp 0</span>
                            </div>
                            <div class="cart-total">
                                <span>Total:</span>
                                <h3 id="cart-total-amount">Rp 0</h3>
                            </div>
                        </div>
                        <div class="payment-method">
                            <label>Metode Pembayaran:</label>
                            <select id="payment-method" class="select-input">
                                <option value="cash">Tunai</option>
                                <option value="transfer">Transfer</option>
                                <option value="qris">QRIS</option>
                                <option value="credit">Kredit</option>
                                </select>
                                </div>
                                <div id="credit-customer-container" class="payment-method" style="display: none;">
                                    <label>Nama Pelanggan:</label>
                                    <input type="text" id="credit-customer-name" class="input" placeholder="Masukkan nama pelanggan..."
                                        autocomplete="off">
                                </div>
                        <button class="btn btn-primary btn-block" id="process-transaction-btn" disabled>
                            Proses Transaksi
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transactions Page -->
        <section id="transactions-page" class="page">
            <header class="page-header">
                <div>
                    <h2>Riwayat Transaksi</h2>
                    <p class="page-subtitle">Daftar semua transaksi penjualan</p>
                </div>
                <button class="btn btn-secondary" id="export-transactions-btn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 17V19H17V17M10 2V14M10 14L6 10M10 14L14 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Export CSV
                </button>
            </header>
            
            <div class="card">
                <div class="card-header">
                    <div class="filter-group">
                        <label>Dari:</label>
                        <input type="date" id="filter-date-from" class="input">
                    </div>
                    <div class="filter-group">
                        <label>Sampai:</label>
                        <input type="date" id="filter-date-to" class="input">
                    </div>
                    <button class="btn btn-secondary" id="filter-transactions-btn">Filter</button>
                    <button class="btn btn-text" id="reset-filter-btn">Reset</button>
                </div>
                <div class="card-body">
                    <div class="table-container">
                        <table id="transactions-table">
                            <thead>
                                <tr>
                                    <th>ID Transaksi</th>
                                    <th>Tanggal</th>
                                    <th>Total</th>
                                    <th>Metode</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="transactions-tbody">
                                <tr class="empty-row">
                                    <td colspan="5">
                                        <div class="empty-state">
                                            <p>Belum ada transaksi</p>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Page -->
        <section id="reports-page" class="page">
            <header class="page-header">
                <h2>Laporan Keuangan</h2>
                <p class="page-subtitle">Analisis pendapatan dan pengeluaran</p>
            </header>
            
            <div class="card">
                <div class="card-header">
                    <select id="report-period" class="select-input">
                        <option value="today">Hari Ini</option>
                        <option value="week">Minggu Ini</option>
                        <option value="month">Bulan Ini</option>
                        <option value="custom">Custom</option>
                    </select>
                    <div id="custom-date-range" class="filter-group" style="display: none;">
                        <input type="date" id="report-date-from" class="input">
                        <span>-</span>
                        <input type="date" id="report-date-to" class="input">
                    </div>
                </div>
                <div class="card-body">
                    <div class="report-summary">
                        <div class="report-item">
                            <p class="report-label">Total Pendapatan</p>
                            <h3 class="report-value positive" id="total-revenue">Rp 0</h3>
                        </div>
                        <div class="report-item">
                            <p class="report-label">Total Pengeluaran</p>
                            <h3 class="report-value negative" id="total-expenses">Rp 0</h3>
                        </div>
                        <div class="report-item">
                            <p class="report-label">Laba/Rugi</p>
                            <h3 class="report-value" id="profit-loss">Rp 0</h3>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="revenue-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>
<!-- Users Page -->
<section id="users-page" class="page">
    <header class="page-header">
        <div>
            <h2>Manajemen Pengguna</h2>
            <p class="page-subtitle">Kelola pengguna dan hak akses sistem</p>
        </div>
        <button class="btn btn-primary" id="add-user-btn">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
            Tambah Pengguna
        </button>
    </header>

    <div class="card">
        <div class="card-header">
            <h3>Daftar Pengguna</h3>
        </div>
        <div class="card-body">
            <div class="table-container">
                <table id="users-table">
                    <thead>
                        <tr>
                            <th>Nama</th>
                            <th>Username</th>
                            <th>Role</th>
                            <th>Dibuat</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="users-tbody">
                        <tr class="empty-row">
                            <td colspan="5">
                                <div class="empty-state">
                                    <p>Memuat data pengguna...</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>
    </main>

    <!-- Modal for User Form -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="user-modal-title">Tambah Pengguna</h3>
                <button class="modal-close" id="close-user-modal">&times;</button>
            </div>
            <form id="user-form">
                <div class="form-group">
                    <label for="user-name-input">Nama Lengkap *</label>
                    <input type="text" id="user-name-input" class="input" required>
                </div>
                <div class="form-group">
                    <label for="user-username">Username *</label>
                    <input type="text" id="user-username" class="input" required>
                </div>
                <div class="form-group">
                    <label for="user-password">Password *</label>
                    <input type="password" id="user-password" class="input" required>
                </div>
                <div class="form-group">
                    <label for="user-role">Role *</label>
                    <select id="user-role" class="select-input" required>
                        <option value="">Pilih Role</option>
                        <option value="admin">Admin</option>
                        <option value="kasir">Kasir</option>
                    </select>
                </div>
                <input type="hidden" id="user-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-user-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Discounts Page -->
    <section id="discounts-page" class="page">
        <div class="page-header">
            <div>
                <h2>Manajemen Diskon</h2>
                <p class="page-subtitle">Kelola diskon dan promosi produk</p>
            </div>
            <button class="btn btn-primary" id="add-discount-btn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 5V15M5 10H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                Tambah Diskon
            </button>
        </div>
    
        <div class="card">
            <div class="card-header">
                <h3>Daftar Diskon</h3>
            </div>
            <div class="card-body">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nama Diskon</th>
                                <th>Nilai</th>
                                <th>Berlaku Untuk</th>
                                <th>Periode</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="discounts-tbody">
                            <tr class="empty-row">
                                <td colspan="6">
                                    <div class="empty-state">
                                        <p>Memuat data diskon...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Modal for Discount Form -->
    <div id="discount-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="discount-modal-title">Tambah Diskon</h3>
                <button class="modal-close" id="close-discount-modal">&times;</button>
            </div>
            <form id="discount-form">
                <div class="form-group">
                    <label for="discount-name">Nama Diskon *</label>
                    <input type="text" id="discount-name" class="input" placeholder="Contoh: Diskon Akhir Tahun" required>
                </div>
    
                <div class="form-row">
                    <div class="form-group">
                        <label for="discount-type">Tipe Diskon *</label>
                        <select id="discount-type" class="select-input" required>
                            <option value="">Pilih Tipe</option>
                            <option value="percentage">Persentase (%)</option>
                            <option value="fixed">Nominal (Rp)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="discount-value">Nilai Diskon *</label>
                        <input type="number" id="discount-value" class="input" min="0" step="0.01"
                            placeholder="Contoh: 10 atau 5000" required>
                    </div>
                </div>
    
                <div class="form-group">
                    <label for="discount-applicable-to">Berlaku Untuk *</label>
                    <select id="discount-applicable-to" class="select-input" required>
                        <option value="">Pilih Kategori</option>
                        <option value="all">Semua Produk</option>
                        <option value="product">Produk Tertentu</option>
                        <option value="category">Kategori Tertentu</option>
                    </select>
                </div>
    
                <div id="discount-products-container" class="form-group" style="display: none;">
                    <label>Pilih Produk</label>
                    <p class="form-hint">Fitur pemilihan produk akan ditambahkan di versi selanjutnya</p>
                </div>
    
                <div id="discount-categories-container" class="form-group" style="display: none;">
                    <label>Pilih Kategori</label>
                    <p class="form-hint">Fitur pemilihan kategori akan ditambahkan di versi selanjutnya</p>
                </div>
    
                <div class="form-row">
                    <div class="form-group">
                        <label for="discount-valid-from">Berlaku Dari *</label>
                        <input type="date" id="discount-valid-from" class="input" required>
                    </div>
                    <div class="form-group">
                        <label for="discount-valid-to">Berlaku Sampai</label>
                        <input type="date" id="discount-valid-to" class="input">
                        <small class="form-hint">Kosongkan untuk tidak terbatas</small>
                    </div>
                </div>
    
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="discount-active" checked>
                        <span>Aktifkan diskon</span>
                    </label>
                </div>
    
                <input type="hidden" id="discount-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-discount-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Customers Page -->
    <section id="customers-page" class="page">
        <div class="page-header">
            <div>
                <h2>Manajemen Pelanggan</h2>
                <p class="page-subtitle">Kelola data pelanggan dan hutang</p>
            </div>
            <button class="btn btn-primary" id="add-customer-btn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 5V15M5 10H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                Tambah Pelanggan
            </button>
        </div>
    
        <div class="card">
            <div class="card-header">
                <h3>Daftar Pelanggan</h3>
                <input type="text" id="search-customers" class="input" placeholder="Cari pelanggan..."
                    style="max-width: 300px;">
            </div>
            <div class="card-body">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Telepon</th>
                                <th>Alamat</th>
                                <th>Total Hutang</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="customers-tbody">
                            <tr class="empty-row">
                                <td colspan="5">
                                    <div class="empty-state">
                                        <p>Memuat data pelanggan...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Debts Page -->
    <section id="debts-page" class="page">
        <div class="page-header">
            <div>
                <h2>Manajemen Hutang</h2>
                <p class="page-subtitle">Kelola hutang pelanggan dan pembayaran</p>
            </div>
            <button class="btn btn-primary" id="add-debt-btn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 5V15M5 10H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                Tambah Hutang
            </button>
        </div>
    
        <div class="card">
            <div class="card-header">
                <h3>Ringkasan Hutang</h3>
            </div>
            <div class="card-body">
                <div id="debt-summary" class="debt-summary">
                    <!-- Summary will be loaded here -->
                </div>
            </div>
        </div>
    
        <div class="card">
            <div class="card-header">
                <h3>Daftar Hutang</h3>
                <div style="display: flex; gap: 1rem;">
                    <select id="debt-status-filter" class="select-input">
                        <option value="">Semua Status</option>
                        <option value="pending">Belum Dibayar</option>
                        <option value="partial">Dibayar Sebagian</option>
                        <option value="paid">Lunas</option>
                        <option value="overdue">Jatuh Tempo</option>
                    </select>
                    <select id="debt-customer-filter" class="select-input">
                        <option value="">Semua Pelanggan</option>
                    </select>
                </div>
            </div>
            <div class="card-body">
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Pelanggan</th>
                                <th>Jumlah</th>
                                <th>Dibayar</th>
                                <th>Sisa</th>
                                <th>Jatuh Tempo</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="debts-tbody">
                            <tr class="empty-row">
                                <td colspan="7">
                                    <div class="empty-state">
                                        <p>Memuat data hutang...</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Customer Modal -->
    <div id="customer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="customer-modal-title">Tambah Pelanggan</h3>
                <button class="modal-close" id="close-customer-modal">&times;</button>
            </div>
            <form id="customer-form">
                <div class="form-group">
                    <label for="customer-name">Nama Pelanggan *</label>
                    <input type="text" id="customer-name" class="input" required>
                </div>
                <div class="form-group">
                    <label for="customer-phone">Telepon</label>
                    <input type="tel" id="customer-phone" class="input" placeholder="08xxxxxxxxxx">
                </div>
                <div class="form-group">
                    <label for="customer-address">Alamat</label>
                    <textarea id="customer-address" class="input" rows="3"></textarea>
                </div>
                <input type="hidden" id="customer-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-customer-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Debt Modal -->
    <div id="debt-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="debt-modal-title">Tambah Hutang</h3>
                <button class="modal-close" id="close-debt-modal">&times;</button>
            </div>
            <form id="debt-form">
                <div class="form-group">
                    <label for="debt-customer">Pelanggan *</label>
                    <select id="debt-customer" class="select-input" required>
                        <option value="">Pilih Pelanggan</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="debt-amount">Jumlah Hutang (Rp) *</label>
                    <input type="number" id="debt-amount" class="input" min="0" required>
                </div>
                <div class="form-group">
                    <label for="debt-due-date">Jatuh Tempo *</label>
                    <input type="date" id="debt-due-date" class="input" required>
                </div>
                <div class="form-group">
                    <label for="debt-notes">Catatan</label>
                    <textarea id="debt-notes" class="input" rows="3" placeholder="Catatan tambahan..."></textarea>
                </div>
                <input type="hidden" id="debt-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-debt-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Payment Modal -->
    <div id="payment-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Catat Pembayaran</h3>
                <button class="modal-close" id="close-payment-modal">&times;</button>
            </div>
            <form id="payment-form">
                <div class="payment-info">
                    <p><strong>Pelanggan:</strong> <span id="payment-customer-name"></span></p>
                    <p><strong>Sisa Hutang:</strong> <span id="payment-remaining"></span></p>
                </div>
                <div class="form-group">
                    <label for="payment-amount">Jumlah Bayar (Rp) *</label>
                    <input type="number" id="payment-amount" class="input" min="0" required>
                </div>
                <div class="form-group">
                    <label for="payment-method">Metode Pembayaran *</label>
                    <select id="payment-method" class="select-input" required>
                        <option value="cash">Tunai</option>
                        <option value="transfer">Transfer</option>
                        <option value="qris">QRIS</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="payment-notes">Catatan</label>
                    <textarea id="payment-notes" class="input" rows="2"></textarea>
                </div>
                <input type="hidden" id="payment-debt-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-payment-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan Pembayaran</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Product Form -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="product-modal-title">Tambah Produk</h3>
                <button class="modal-close" id="close-product-modal">&times;</button>
            </div>
            <form id="product-form">
                <div class="form-group">
                    <label for="product-name">Nama Produk *</label>
                    <input type="text" id="product-name" class="input" required>
                </div>
                <div class="form-group">
                    <label for="product-category">Kategori *</label>
                    <select id="product-category" class="select-input" required>
                        <option value="">Pilih Kategori</option>
                        <option value="makanan">Makanan</option>
                        <option value="minuman">Minuman</option>
                        <option value="snack">Snack</option>
                        <option value="lainnya">Lainnya</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="product-barcode">Barcode (Opsional)</label>
                    <div class="barcode-input-group">
                        <input type="text" id="product-barcode" class="input" placeholder="Scan atau masukkan barcode">
                        <button type="button" class="btn btn-secondary btn-icon" onclick="scanBarcodeForProduct()" title="Scan Barcode">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M3 7V5C3 3.89543 3.89543 3 5 3H7M17 3H19C20.1046 3 21 3.89543 21 5V7M21 17V19C21 20.1046 20.1046 21 19 21H17M7 21H5C3.89543 21 3 20.1046 3 19V17"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                <path
                                    d="M7 8H7.01M7 12H7.01M7 16H7.01M11 8H11.01M11 12H11.01M11 16H11.01M15 8H15.01M15 12H15.01M15 16H15.01"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                        </button>
                        <button type="button" class="btn btn-secondary btn-icon" onclick="generateBarcodeForProduct()"
                            title="Generate Barcode">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 10V3L4 14H11V21L20 10H13Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="product-price">Harga (Rp) *</label>
                        <input type="number" id="product-price" class="input" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="product-stock">Stok *</label>
                        <input type="number" id="product-stock" class="input" min="0" required>
                    </div>
                </div>
                <input type="hidden" id="product-id">
                <div class="modal-footer">
                    <button type="button" class="btn btn-text" id="cancel-product-btn">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Transaction Detail -->
    <div id="transaction-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detail Transaksi</h3>
                <button class="modal-close" id="close-transaction-modal">&times;</button>
            </div>
            <div id="transaction-detail" class="transaction-detail">
                <!-- Transaction details will be loaded here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-text" id="close-detail-btn">Tutup</button>
                <button type="button" class="btn btn-secondary" id="print-receipt-btn">Cetak Struk</button>
            </div>
        </div>
    </div>

<!-- Logout Confirmation Modal -->
<div id="logout-modal" class="modal">
    <div class="modal-content modal-small">
        <div class="modal-header">
            <h3>Konfirmasi Logout</h3>
            <button class="modal-close" id="close-logout-modal">&times;</button>
        </div>
        <div class="modal-body">
            <div class="logout-icon">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M16 17L21 12L16 7" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                    <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" />
                </svg>
            </div>
            <p class="logout-message">Apakah Anda yakin ingin keluar dari sistem?</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="cancel-logout-btn">Batal</button>
            <button type="button" class="btn btn-danger" id="confirm-logout-btn">Ya, Logout</button>
        </div>
    </div>
</div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/database.js"></script>
    <script src="js/auth-v2.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/products.js"></script>
    <script src="js/pos.js"></script>
    <script src="js/transactions.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/users.js"></script>
    <script src="js/discounts.js"></script>
    <script src="js/customers.js"></script>
    <script src="js/debts.js"></script>
    <script src="js/barcode.js"></script>
    <script src="js/mobile.js"></script>
    <!-- Phase 6-9 Modules -->
    <script src="js/supabase.js"></script>
    <script src="js/activity-log.js"></script>
    <script src="js/permissions.js"></script>
    <script src="js/expenses.js"></script>
    <script src="js/financial-reports.js"></script>
    <script src="js/receipt-printer.js"></script>
    <script src="js/backup.js"></script>
    <script src="js/offline-sync.js"></script>
    <script src="app.js"></script>
</body>
</html>
